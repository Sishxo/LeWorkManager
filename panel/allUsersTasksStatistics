                    <!-- Page Heading -->
                    <h1 class="h3 mb-2 text-gray-800">工作量统计汇总</h1>
                    <p class="mb-4">统计各用户的任务工作完成情况</p>

                    <!-- DataTales -->
                    <div class="card shadow mb-4">
                        <!-- 卡片标题 -->
                        <div class="card-header py-3">
                            <div style="display:inline-block;margin-top:8px">
                                <h6 class="m-0 font-weight-bold text-primary">统计时间</h6>
                            </div>
                            <div style="float:right">
                                <a href="javascript:statisticsChange()" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
                                    <i class="fas fa-pen fa-sm text-white-50"></i> 开始统计
                                </a>
                            </div>
                        </div>

                        <!-- 卡片内容 -->
                        <div class="card-body">
                            <div class="table-responsive">
                                <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
                                    <!-- 统计时间 -->
                                    <div class="row" style="margin-bottom:0.5rem">
                                        
                                        <!-- 统计开始时间 -->
                                        <div class="col-sm-12 col-md-6">
                                            <div class="dataTables_length" id="">
                                                <label>
                                                    <div style="height:40px">
                                                        <div style="display:inline-block;padding-top:8px">
                                                            <font>统计开始时间<font color="red">*</font>：</font>
                                                        </div>
                                                        <div style="display:inline-block;width:60%">
                                                            <input type="text" class="form-control layui-input" id="startDateTime">
                                                        </div>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>

                                        <!-- 统计结束时间 -->
                                        <div class="col-sm-12 col-md-6">
                                            <div class="dataTables_length" id="">
                                                <label>
                                                    <div style="height:40px">
                                                        <div style="display:inline-block;padding-top:8px">
                                                            <font>统计结束时间<font color="red">*</font>：</font>
                                                        </div>
                                                        <div style="display:inline-block;width:60%">
                                                            <input type="text" class="form-control layui-input" id="endDateTime">
                                                        </div>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DataTales -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">任务量统计表</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
                                    <!-- 表格上方 -->
                                    <div class="row" style="margin-bottom:0.5rem">
                                        
                                        <!-- 每页显示几条 -->
                                        <div class="col-sm-12 col-md-6">
                                            <div class="dataTables_length" id="dataTable_length">
                                                <label>
                                                    <div style="display:inline-block; margin-right:5px">
                                                        <font>每页显示</font>
                                                    </div>

                                                    <div style="display:inline-block">
                                                        <select id="allUsersTasksStatistics_length" aria-controls="dataTable" class="custom-select custom-select-sm form-control form-control-sm" onchange="allUsersTasksStatistics_lengthChange()">
                                                            <option value="10">10</option>
                                                            <option value="25">25</option>
                                                            <option value="50">50</option>
                                                            <option value="100">100</option>
                                                        </select>
                                                    </div>

                                                    <div style="display:inline-block; margin-left: 5px">
                                                        <font>条</font>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>

                                        <!-- 搜索框 -->
                                        <div class="col-sm-12 col-md-6">
                                            <div id="dataTable_filter" class="dataTables_filter">
                                                <label>
                                                    <div style="display:inline-block">
                                                        <font>筛选查找：</font>
                                                    </div>

                                                    <div style="display:inline-block">
                                                        <input id="allUsersTasksStatisticsCondition" type="search" class="form-control form-control-sm" aria-controls="dataTable" onKeyUp="allUsersTasksStatisticsChange()">
                                                        </input>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 表格本体 -->
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <table class="table table-bordered" id="allUsersTasksStatisticsTable" onclick="allUsersTasksStatisticsClick()" width="100%" cellspacing="0">
                                                <thead>
                                                    <tr>
                                                        <th width="10%">序号</th>
                                                        <th width="15%">执行人</th>
                                                        <th width="15%">领取任务数量</th>
                                                        <th width="15%">完成任务数量</th>
                                                        <th width="15%">结算数量</th>
                                                        <th width="15%">共结算泺研币</th>
                                                        <th width="15%">共结算泺学分</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- 表格下方 -->
                                    <div class=row>
                                        
                                        <!-- 显示编号 -->
                                        <div class="col-sm-12 col-md-5">
                                            <label>
                                                <div style="display:inline-block; margin-right:5px">
                                                    <font>第</font>
                                                </div>

                                                <div style="display:inline-block;width:20%">
                                                    <input id="allUsersTasksStatisticsPageInput" class="form-control form-control-sm" onchange="allUsersTasksStatisticsPageInputChange()">
                                                    </input>
                                                </div>

                                                <div style="display:inline-block; margin-left: 5px">
                                                    <font>页</font>
                                                </div>
                                            </label>
                                        </div>

                                        <!-- 上一页 下一页 -->
                                        <div class="col-sm-12 col-md-7">
                                            <div class="dataTables_paginate paging_simple_numbers" id="dataTable_paginate">
                                                <ul class="pagination">
                                                    <li class="paginate_button page-item" id="dataTable_previous">
                                                        <button id="allUsersTasksStatisticsPageReduct" onclick="allUsersTasksStatisticsPageReduct()" class="page-link">
                                                            上一页
                                                        </button>
                                                    </li>
                                                    <li class="paginate_button page-item" id="dataTable_previous">
                                                        <button id="allUsersTasksStatisticsPagePlus" onclick="allUsersTasksStatisticsPagePlus()" class="page-link">
                                                            下一页
                                                        </button>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DataTales -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">统计图表</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
                                    
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 模态框 -->

                    <!-- 统计详情 Modal-->
                    <div class="modal fade" id="allUsersTaskInfoModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content" style="width:300%; margin:0 -100%">

                                <!-- 传参 -->
                                <input type="hidden" id="userId">

                                <div class="modal-header">
                                    <h5 id="userTaskInfoModalTitle" class="modal-title"></h5>
                                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <!-- DataTales -->
                                    <div class="table-responsive">
                                        <div id="dataTable_wrapper" class="dataTables_wrapper dt-bootstrap4">
                                            <!-- 表格上方 -->
                                            <div class="row" style="margin-bottom:0.5rem">
                                                        
                                                <!-- 每页显示几条 -->
                                                <div class="col-sm-12 col-md-6">
                                                    <div class="dataTables_length" id="dataTable_length">
                                                        <label>
                                                            <div style="display:inline-block; margin-right:5px">
                                                                <font>每页显示</font>
                                                            </div>

                                                            <div style="display:inline-block">
                                                                <select id="allUsersTasksInfo_length" aria-controls="dataTable" class="custom-select custom-select-sm form-control form-control-sm" onchange="allUsersTasksInfo_lengthChange()">
                                                                    <option value="10">10</option>
                                                                    <option value="25">25</option>
                                                                    <option value="50">50</option>
                                                                    <option value="100">100</option>
                                                                </select>
                                                            </div>

                                                            <div style="display:inline-block; margin-left: 5px">
                                                                <font>条</font>
                                                            </div>
                                                        </label>
                                                    </div>
                                                </div>

                                                <!-- 搜索框 -->
                                                <div class="col-sm-12 col-md-6">
                                                    <div id="dataTable_filter" class="dataTables_filter">
                                                        <label>
                                                            <div style="display:inline-block">
                                                                <font>筛选查找：</font>
                                                            </div>

                                                            <div style="display:inline-block">
                                                                <input id="allUsersTasksInfoCondition" type="search" class="form-control form-control-sm" aria-controls="dataTable" onKeyUp="allUsersTasksInfoChange()">
                                                                </input>
                                                            </div>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 表格本体 -->
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <table class="table table-bordered" id="allUsersTasksInfoTable" width="100%" cellspacing="0">
                                                        <thead>
                                                            <tr>
                                                                <th>序号</th>
                                                                <th>任务名称</th>
                                                                <th>计划完成时间</th>
                                                                <th>项目进度</th>
                                                                <th>是否已完成</th>
                                                                <th>实际完成时间</th>
                                                                <th>是否已结算</th>
                                                                <th>复审人</th>
                                                                <th>复审时间</th>
                                                                <th>结算泺研币</th>
                                                                <th>结算泺学分</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>

                                            <!-- 表格下方 -->
                                            <div class=row>
                                                        
                                                <!-- 显示编号 -->
                                                <div class="col-sm-12 col-md-5">
                                                    <label>
                                                        <div style="display:inline-block; margin-right:5px">
                                                            <font>第</font>
                                                        </div>

                                                        <div style="display:inline-block;width:20%">
                                                            <input id="allUsersTasksInfoPageInput" class="form-control form-control-sm" onchange="allUsersTasksInfoPageInputChange()">
                                                            </input>
                                                        </div>

                                                        <div style="display:inline-block; margin-left: 5px">
                                                            <font>页</font>
                                                        </div>
                                                    </label>
                                                </div>

                                                <!-- 上一页 下一页 -->
                                                <div class="col-sm-12 col-md-7">
                                                    <div class="dataTables_paginate paging_simple_numbers" id="dataTable_paginate">
                                                        <ul class="pagination">
                                                            <li class="paginate_button page-item" id="dataTable_previous">
                                                                <button id="allUsersTasksInfoPageReduct" onclick="allUsersTasksInfoPageReduct()" class="page-link">
                                                                    上一页
                                                                </button>
                                                            </li>
                                                            <li class="paginate_button page-item" id="dataTable_previous">
                                                                <button id="allUsersTasksInfoPagePlus" onclick="allUsersTasksInfoPagePlus()" class="page-link">
                                                                    下一页
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" type="button" data-dismiss="modal">取消</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="maxAllUsersTasksStatisticsPage" style="display:none"></div>
                    <div id="maxAllUsersTasksInfoPage" style="display:none"></div>

                    <!-- JS脚本 -->
                    <script type="text/javascript">
                        // 初始化页码
                        var allUsersTasksStatisticsPage = 1
                        var allUsersTasksInfoPage = 1
                        var oldUserInfoCondition = ""
                        var oldUserTasksInfoCondition = ""

                        if (userInfoJson.permit > 2)
                        {
                            toastr.error("没有访问权限")
                            // 延时
                            setTimeout( function(){
                                // 跳转
                                window.location.href="../index.php?nowPage=index"
                            }, 0 * 1000 );//延迟2000毫秒
                        }

                        /* ------------- 用户名单 -------------*/

                        // 获取用户名单统计表
                        function getTasksStatistics()
                        {
                            $.ajax({
                                contentType: "application/x-www-form-urlencoded",
                                url:"../api/getUsersStatistics.php",
                                type: "POST",
                                data:{
                                    page: allUsersTasksStatisticsPage,
                                    length: $('#allUsersTasksStatistics_length option:selected').val(),
                                    allUsersTasksStatisticsCondition: document.getElementById("allUsersTasksStatisticsCondition").value,
                                    startDateTime: document.getElementById("startDateTime").value,
                                    endDateTime: document.getElementById("endDateTime").value
                                },
                                success:function(res){
                                    // console.log(res)
                                    var res_json = JSON.parse(res)
                                    // console.log(res_json)
                                    // console.log(res_json.code)
                                    if (res_json.code == 200)
                                    {
                                        // 获取成功
                                        // console.log(res_json.message)
                                        userInfoList = res_json.message
                                        
                                        // 显示到列表
                                        $.each(res_json.message, function(i, userInfo) {
                                            var index = (allUsersTasksStatisticsPage - 1) * $('#allUsersTasksStatistics_length option:selected').val() + Number(i) + 1

                                            // getUserTasks(userInfo)
                                            
                                            let str="<tr>"            
                                                + "<td>" + index + "</td>"
                                                + "<td>" + userInfo.name+ "</td>"
                                                + "<td>" + userInfo.joinedTasksCount + "</td>"
                                                + "<td>" + userInfo.finishedTasksCount + "</td>"
                                                + "<td>" + userInfo.reCheckSum + "</td>"
                                                + "<td>" + userInfo.moneySum + "</td>"
                                                + "<td>" + userInfo.pointSum + "</td>"
                                                + "</tr>";

                                            $("#allUsersTasksStatisticsTable").append(str);
                                        })

                                        // 翻页按钮禁用判断
                                        if (allUsersTasksStatisticsPage == 1)
                                        {
                                            document.getElementById('allUsersTasksStatisticsPageReduct').disabled = "disabled"
                                            document.getElementById('allUsersTasksStatisticsPageReduct').className = "page-link disabled"
                                        }
                                        else
                                        {
                                            document.getElementById('allUsersTasksStatisticsPageReduct').disabled = ""
                                            document.getElementById('allUsersTasksStatisticsPageReduct').className = "page-link"
                                        }

                                        var maxCheckedPage = Math.ceil(Number(res_json.listLength) / Number($('#allUsersTasksStatistics_length option:selected').val()))

                                        if (allUsersTasksStatisticsPage >= maxCheckedPage)
                                        {
                                            document.getElementById('allUsersTasksStatisticsPagePlus').disabled = "disabled"
                                            document.getElementById('allUsersTasksStatisticsPagePlus').className = "page-link disabled"
                                        }
                                        else
                                        {
                                            document.getElementById('allUsersTasksStatisticsPagePlus').disabled = ""
                                            document.getElementById('allUsersTasksStatisticsPagePlus').className = "page-link"
                                        }

                                        // 页码填进去框里
                                        document.getElementById('allUsersTasksStatisticsPageInput').value = allUsersTasksStatisticsPage
                                        document.getElementById('allUsersTasksStatisticsPageInput').disabled = ""
                                        document.getElementById('maxAllUsersTasksStatisticsPage').innerHTML = maxCheckedPage
                                    }
                                    else
                                    {
                                        // 获取失败，显示原因
                                        // console.log("获取任务类型失败")
                                        document.getElementById('maxAllUsersTasksStatisticsPage').innerHTML = 0
                                        document.getElementById('allUsersTasksStatisticsPageInput').disabled = "disabled"
                                        document.getElementById('allUsersTasksStatisticsPageInput').value = ""
                                        document.getElementById('allUsersTasksStatisticsPageReduct').disabled = "disabled"
                                        document.getElementById('allUsersTasksStatisticsPageReduct').className = "page-link disabled"
                                        document.getElementById('allUsersTasksStatisticsPagePlus').disabled = "disabled"
                                        document.getElementById('allUsersTasksStatisticsPagePlus').className = "page-link disabled"
                                        let str="<tr><td colspan=\"7\" align=\"center\"> 未获取到用户信息 </td></tr>"
                                        $("#allUsersTasksStatisticsTable").append(str);
                                    }
                                }
                            })
                        }

                        calcuTime()

                        // 任务量统计 每页显示条数修改
                        function allUsersTasksStatistics_lengthChange()
                        {
                            allUsersTasksStatisticsPage = 1
                            allUsersTasksStatisticsReload()
                        }

                        function allUsersTasksStatisticsReload()
                        {
                            document.getElementById('allUsersTasksStatisticsTable').innerHTML = "<thead> \
                                                    <tr> \
                                                        <th width=\"10%\">序号</th> \
                                                        <th width=\"15%\">执行人</th> \
                                                        <th width=\"15%\">领取任务数量</th> \
                                                        <th width=\"15%\">完成任务数量</th> \
                                                        <th width=\"15%\">结算数量</th> \
                                                        <th width=\"15%\">共结算泺研币</th> \
                                                        <th width=\"15%\">共结算泺学分</th> \
                                                    </tr> \
                                                </thead> \
                                                <tbody> \
                                                </tbody>"
                            getTasksStatistics()
                        }

                        // 筛选条件改变
                        function allUsersTasksStatisticsChange()
                        {
                            var nowUserInfoCondition = document.getElementById("allUsersTasksStatisticsCondition").value

                            if (oldUserInfoCondition != nowUserInfoCondition)
                            {
                                console.log(nowUserInfoCondition)
                                console.log(oldUserInfoCondition)
                                allUsersTasksStatisticsReload()

                                oldUserInfoCondition = nowUserInfoCondition
                            }
                        }

                        // 统计所有用户任务量点击事件
                        function allUsersTasksStatisticsClick()
                        {
                            // 获取点击任务的id号
                            var td = event.srcElement; // 通过event.srcElement 获取激活事件的对象 td
                            if (isNaN(td.parentElement.rowIndex))
                            {
                                var tdd = td.parentElement.parentElement.rowIndex
                            }
                            else
                            {
                                var tdd = td.parentElement.rowIndex
                            }
                            // console.log(td.parentElement.rowIndex + 1)
                            // console.log(td.parentElement.children[1].innerHTML)
                            // console.log(tdd)
                            if ((tdd > 0) && (document.getElementById('maxAllUsersTasksStatisticsPage').innerHTML > 0))
                            {
                                // console.log(userInfoList[tdd - 1])
                                clickId = userInfoList[tdd - 1].id
                                // console.log(clickId)
                                document.getElementById('userId').value = clickId
                                // console.log(document.getElementById('userId').value)

                                document.getElementById('userTaskInfoModalTitle').innerHTML = userInfoList[tdd - 1].name + "的任务完成情况统计"

                                allUsersTasksInfoReload()
                                
                                $('#allUsersTaskInfoModal').modal('show')
                            }
                        }

                        // 页码加减
                        function allUsersTasksStatisticsPageReduct()
                        {
                            allUsersTasksStatisticsPage = allUsersTasksStatisticsPage - 1
                            allUsersTasksStatisticsReload()
                        }

                        function allUsersTasksStatisticsPagePlus()
                        {
                            allUsersTasksStatisticsPage = allUsersTasksStatisticsPage + 1
                            allUsersTasksStatisticsReload()
                        }

                        // 可报名任务页码突变
                        function allUsersTasksStatisticsPageInputChange()
                        {
                            if (!(/(^[0-9]*[1-9][0-9]*$)/.test(document.getElementById('allUsersTasksStatisticsPageInput').value)))
                            {
                                // 非正整数
                                if (document.getElementById('maxAllUsersTasksStatisticsPage').innerHTML == 0)
                                {
                                    document.getElementById('allUsersTasksStatisticsPageInput').value = ""
                                }
                                else
                                {
                                    document.getElementById('allUsersTasksStatisticsPageInput').value = allUsersTasksStatisticsPage
                                }

                                toastr.error("页码格式错误")
                            }
                            else if (document.getElementById('allUsersTasksStatisticsPageInput').value > document.getElementById('maxAllUsersTasksStatisticsPage').innerHTML)
                            {
                                // 页码超出了最大页
                                if (document.getElementById('maxAllUsersTasksStatisticsPage').innerHTML == 0)
                                {
                                    document.getElementById('allUsersTasksStatisticsPageInput').value = ""
                                }
                                else
                                {
                                    document.getElementById('allUsersTasksStatisticsPageInput').value = allUsersTasksStatisticsPage
                                }

                                toastr.error("页码已超出总数")
                            }
                            else
                            {
                                allUsersTasksStatisticsPage = Number(document.getElementById('allUsersTasksStatisticsPageInput').value)
                                allUsersTasksStatisticsReload()
                            }
                        }

                        /* ------------- 用户名单 -------------*/

                        /* ------------- 用户任务详情 -------------*/

                        // 获取指定用户的任务数据
                        function getUserTasks()
                        {
                            // console.log(document.getElementById('userId').value)
                            // console.log(document.getElementById("startDateTime").value)
                            // console.log(document.getElementById("endDateTime").value)
                            // console.log(allUsersTasksInfoPage)
                            // console.log($('#allUsersTasksInfo_length option:selected').val())
                            // console.log(document.getElementById("allUsersTasksInfoCondition").value)
                            $.ajax({
                                contentType: "application/x-www-form-urlencoded",
                                url:"../api/getUserTasksLimitTime.php",
                                type: "POST",
                                data:{
                                    userId: document.getElementById('userId').value,
                                    startTime: document.getElementById("startDateTime").value,
                                    endTime: document.getElementById("endDateTime").value,
                                    page: allUsersTasksInfoPage,
                                    length: $('#allUsersTasksInfo_length option:selected').val(),
                                    allUsersTasksInfoCondition: document.getElementById("allUsersTasksInfoCondition").value
                                },
                                success:function(res){
                                    // console.log(res)
                                    var res_json = JSON.parse(res)
                                    // console.log(res_json)
                                    // console.log(res_json.code)
                                    if (res_json.code == 200)
                                    {
                                        // 获取成功
                                        // console.log(res_json.message)
                                        
                                        // 显示到列表
                                        $.each(res_json.message, function(i, taskInfo) {
                                            var index = (allUsersTasksInfoPage - 1) * $('#allUsersTasksInfo_length option:selected').val() + Number(i) + 1

                                            // getUserTasks(taskInfo)

                                            // 是否已完成
                                            if (taskInfo.realEndFlag == 1)
                                            {
                                                finishedText = "<input type=\"checkbox\" disabled=\"disabled\" checked=\"checked\"></input>"
                                                realEndTimeText = taskInfo.realEndTime
                                            }
                                            else
                                            {
                                                finishedText = "<input type=\"checkbox\" disabled=\"disabled\"></input>"
                                                realEndTimeText = "--"
                                            }

                                            // 是否已结算
                                            if (taskInfo.scoreCheck == 1)
                                            {
                                                reCheckBoxText = "<input type=\"checkbox\" disabled=\"disabled\" checked=\"checked\"></input>"
                                                reCheckPersonText = taskInfo.scoreCheckInfo.checkAdminName
                                                reCheckTimeText = taskInfo.scoreCheckInfo.insertDateTime
                                                reCheckMoneyText = taskInfo.scoreCheckInfo.taskMoney
                                                reCheckPointText = taskInfo.scoreCheckInfo.taskPoint
                                            }
                                            else
                                            {
                                                reCheckBoxText = "<input type=\"checkbox\" disabled=\"disabled\"></input>"
                                                reCheckPersonText = "--"
                                                reCheckTimeText = "--"
                                                reCheckMoneyText = "<font color=\"red\">" + taskInfo.taskMoney + "</font>"
                                                reCheckPointText = "<font color=\"red\">" + taskInfo.taskPoint + "</font>"
                                            }

                                            // 任务进度
                                            var taskPercentText = "<td style=\"vertical-align:middle\"> <div class=\"progress\"> \
                                                    <div class=\"progress-bar\" role=\"progressbar\" style=\"width:" + taskInfo.maxPercent + "%;\" aria-valuenow=\"" + taskInfo.maxPercent + "\" aria-valuemin=\"0\" aria-valuemax=\"100\">" + taskInfo.maxPercent + "%</div> \
                                                   </div> </td>"

                                            let str="<tr>"            
                                                + "<td>" + index + "</td>"
                                                + "<td>" + taskInfo.proName+ "</td>"
                                                + "<td>" + taskInfo.endTime + "</td>"
                                                + taskPercentText
                                                + "<td>" + finishedText + "</td>"
                                                + "<td>" + realEndTimeText + "</td>"
                                                + "<td>" + reCheckBoxText + "</td>"
                                                + "<td>" + reCheckPersonText + "</td>"
                                                + "<td>" + reCheckTimeText + "</td>"
                                                + "<td>" + reCheckMoneyText + "</td>"
                                                + "<td>" + reCheckPointText + "</td>"
                                                + "</tr>";

                                            $("#allUsersTasksInfoTable").append(str);
                                        })

                                        // 翻页按钮禁用判断
                                        if (allUsersTasksInfoPage == 1)
                                        {
                                            document.getElementById('allUsersTasksInfoPageReduct').disabled = "disabled"
                                            document.getElementById('allUsersTasksInfoPageReduct').className = "page-link disabled"
                                        }
                                        else
                                        {
                                            document.getElementById('allUsersTasksInfoPageReduct').disabled = ""
                                            document.getElementById('allUsersTasksInfoPageReduct').className = "page-link"
                                        }

                                        var maxCheckedPage = Math.ceil(Number(res_json.listLength) / Number($('#allUsersTasksInfo_length option:selected').val()))

                                        if (allUsersTasksInfoPage >= maxCheckedPage)
                                        {
                                            document.getElementById('allUsersTasksInfoPagePlus').disabled = "disabled"
                                            document.getElementById('allUsersTasksInfoPagePlus').className = "page-link disabled"
                                        }
                                        else
                                        {
                                            document.getElementById('allUsersTasksInfoPagePlus').disabled = ""
                                            document.getElementById('allUsersTasksInfoPagePlus').className = "page-link"
                                        }

                                        // 页码填进去框里
                                        document.getElementById('allUsersTasksInfoPageInput').value = allUsersTasksInfoPage
                                        document.getElementById('allUsersTasksInfoPageInput').disabled = ""
                                        document.getElementById('maxAllUsersTasksInfoPage').innerHTML = maxCheckedPage
                                    }
                                    else
                                    {
                                        // 获取失败，显示原因
                                        document.getElementById('maxAllUsersTasksInfoPage').innerHTML = 0
                                        document.getElementById('allUsersTasksInfoPageInput').disabled = "disabled"
                                        document.getElementById('allUsersTasksInfoPageInput').value = ""
                                        document.getElementById('allUsersTasksInfoPageReduct').disabled = "disabled"
                                        document.getElementById('allUsersTasksInfoPageReduct').className = "page-link disabled"
                                        document.getElementById('allUsersTasksInfoPagePlus').disabled = "disabled"
                                        document.getElementById('allUsersTasksInfoPagePlus').className = "page-link disabled"
                                        let str="<tr><td colspan=\"10\" align=\"center\"> 未获取到该用户详细任务信息 </td></tr>"
                                        $("#allUsersTasksInfoTable").append(str);
                                    }
                                }
                            })
                        }

                        function allUsersTasksInfo_lengthChange()
                        {
                            allUsersTasksInfoPage = 1
                            allUsersTasksInfoReload()
                        }

                        function allUsersTasksInfoReload()
                        {
                            document.getElementById('allUsersTasksInfoTable').innerHTML = "<thead> \
                                                    <tr> \
                                                        <th>序号</th> \
                                                        <th>任务名称</th> \
                                                        <th>计划完成时间</th> \
                                                        <th>项目进度</th> \
                                                        <th>是否已完成</th> \
                                                        <th>实际完成时间</th> \
                                                        <th>是否已结算</th> \
                                                        <th>复审人</th> \
                                                        <th>复审时间</th> \
                                                        <th>结算泺研币</th> \
                                                        <th>结算泺学分</th> \
                                                    </tr> \
                                                </thead> \
                                                <tbody> \
                                                </tbody>"
                            getUserTasks()
                        }

                        // 筛选条件改变
                        function allUsersTasksInfoChange()
                        {
                            var nowUserInfoCondition = document.getElementById("allUsersTasksInfoCondition").value

                            if (oldUserInfoCondition != nowUserInfoCondition)
                            {
                                console.log(nowUserInfoCondition)
                                console.log(oldUserInfoCondition)
                                allUsersTasksInfoReload()

                                oldUserInfoCondition = nowUserInfoCondition
                            }
                        }

                        // 页码加减
                        function allUsersTasksInfoPageReduct()
                        {
                            allUsersTasksInfoPage = allUsersTasksInfoPage - 1
                            allUsersTasksInfoReload()
                        }

                        function allUsersTasksInfoPagePlus()
                        {
                            allUsersTasksInfoPage = allUsersTasksInfoPage + 1
                            allUsersTasksInfoReload()
                        }

                        // 可报名任务页码突变
                        function allUsersTasksInfoPageInputChange()
                        {
                            if (!(/(^[0-9]*[1-9][0-9]*$)/.test(document.getElementById('allUsersTasksInfoPageInput').value)))
                            {
                                // 非正整数
                                if (document.getElementById('maxAllUsersTasksInfoPage').innerHTML == 0)
                                {
                                    document.getElementById('allUsersTasksInfoPageInput').value = ""
                                }
                                else
                                {
                                    document.getElementById('allUsersTasksInfoPageInput').value = allUsersTasksInfoPage
                                }

                                toastr.error("页码格式错误")
                            }
                            else if (document.getElementById('allUsersTasksInfoPageInput').value > document.getElementById('maxAllUsersTasksInfoPage').innerHTML)
                            {
                                // 页码超出了最大页
                                if (document.getElementById('maxAllUsersTasksInfoPage').innerHTML == 0)
                                {
                                    document.getElementById('allUsersTasksInfoPageInput').value = ""
                                }
                                else
                                {
                                    document.getElementById('allUsersTasksInfoPageInput').value = allUsersTasksInfoPage
                                }

                                toastr.error("页码已超出总数")
                            }
                            else
                            {
                                allUsersTasksInfoPage = Number(document.getElementById('allUsersTasksInfoPageInput').value)
                                allUsersTasksInfoReload()
                            }
                        }

                        /* ------------- 用户任务详情 -------------*/

                        // 计算起止时间并自动填上
                        function calcuTime()
                        {
                            var date = new Date()
                            var day_30 = new Date().setMonth((new Date().getMonth()-1))    //日期是30天前的对应时间戳
                            date_30 = new Date(day_30)       //转换成标准时间
			
                            var endYear = date.getFullYear()        //年 ,从 Date 对象以四位数字返回年份
                            var endMonth = date.getMonth() + 1      //月 ,从 Date 对象返回月份 (0 ~ 11) ,date.getMonth()比实际月份少 1 个月
                            var endDay = date.getDate()             //日 ,从 Date 对象返回一个月中的某一天 (1 ~ 31)
                            var startYear = date_30.getFullYear()
                            var startMonth = date_30.getMonth() + 1
                            var startDay = date_30.getDate()             
                            
                            //修改月份格式
                            if (startMonth >= 1 && startMonth <= 9)
                            {
                                startMonth = "0" + startMonth;
                            }

                            if (endMonth >= 1 && endMonth <= 9)
                            {
                                endMonth = "0" + endMonth;
                            }
                            
                            //修改日期格式
                            if (startDay >= 1 && startDay <= 9)
                            {
                                startDay = "0" + startDay;
                            }

                            if (endDay >= 1 && endDay <= 9)
                            {
                                endDay = "0" + endDay;
                            }
                            
                            //格式化
                            var endDate = endYear + "-" + endMonth + "-" + endDay + " 23:59:59"
                            var startDate = startYear + "-" + startMonth + "-" + startDay + " 00:00:00"
                            document.getElementById("startDateTime").value = startDate
                            document.getElementById("endDateTime").value = endDate

                            // 调用
                            getTasksStatistics()
                        }

                        // 统计时间改变
                        function statisticsChange()
                        {
                            // 重新获取表格
                            allUsersTasksStatistics_lengthChange()
                        }

                        // 日期时间选择器
                        laydate.render({
                            elem: '#startDateTime', //指定元素
                            type: 'datetime'
                        });

                        // 日期时间选择器
                        laydate.render({
                            elem: '#endDateTime', //指定元素
                            type: 'datetime'
                        });
                    </script>